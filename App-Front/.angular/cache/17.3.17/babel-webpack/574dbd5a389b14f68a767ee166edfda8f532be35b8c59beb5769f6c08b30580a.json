{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport { tap } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class AuthService {\n  constructor(http) {\n    this.http = http;\n    this.apiUrl = 'http://localhost:3000/api/auth';\n    this.currentUserSubject = new BehaviorSubject(null);\n    this.currentUser$ = this.currentUserSubject.asObservable();\n    this.loadCurrentUser();\n  }\n  loadCurrentUser() {\n    const token = this.getToken();\n    if (token) {\n      // Verificar token\n      this.verificarToken().subscribe({\n        next: data => this.currentUserSubject.next(data.user),\n        error: () => this.logout()\n      });\n    }\n  }\n  register(userData) {\n    return this.http.post(`${this.apiUrl}/registro`, userData);\n  }\n  login(username, password) {\n    return this.http.post(`${this.apiUrl}/login`, {\n      username,\n      password\n    }).pipe(tap(response => {\n      localStorage.setItem('token', response.token);\n      this.currentUserSubject.next(response.user);\n    }));\n  }\n  logout() {\n    localStorage.removeItem('token');\n    this.currentUserSubject.next(null);\n  }\n  getToken() {\n    return localStorage.getItem('token');\n  }\n  isAuthenticated() {\n    return !!this.getToken();\n  }\n  isLoggedIn() {\n    return this.isAuthenticated();\n  }\n  getCurrentUser() {\n    return this.currentUserSubject.value;\n  }\n  verificarToken() {\n    return this.http.get(`${this.apiUrl}/verificar`);\n  }\n  static {\n    this.ɵfac = function AuthService_Factory(t) {\n      return new (t || AuthService)(i0.ɵɵinject(i1.HttpClient));\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: AuthService,\n      factory: AuthService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["BehaviorSubject","tap","AuthService","constructor","http","apiUrl","currentUserSubject","currentUser$","asObservable","loadCurrentUser","token","getToken","verificarToken","subscribe","next","data","user","error","logout","register","userData","post","login","username","password","pipe","response","localStorage","setItem","removeItem","getItem","isAuthenticated","isLoggedIn","getCurrentUser","value","get","i0","ɵɵinject","i1","HttpClient","factory","ɵfac","providedIn"],"sources":["C:\\Users\\rodri\\OneDrive\\Escritorio\\HERRAMIENTAS DESARROLLO\\PRIME-FINAL\\HD--CicloVIII-PrimeFit\\App-Front\\src\\app\\services\\auth.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Observable, BehaviorSubject } from 'rxjs';\r\nimport { tap } from 'rxjs/operators';\r\n\r\nexport interface User {\r\n  id: number;\r\n  username: string;\r\n  email: string;\r\n  nombre: string;\r\n  apellido: string;\r\n  role: string;\r\n}\r\n\r\nexport interface AuthResponse {\r\n  token: string;\r\n  user: User;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class AuthService {\r\n  private apiUrl = 'http://localhost:3000/api/auth';\r\n  private currentUserSubject = new BehaviorSubject<User | null>(null);\r\n  public currentUser$ = this.currentUserSubject.asObservable();\r\n\r\n  constructor(private http: HttpClient) {\r\n    this.loadCurrentUser();\r\n  }\r\n\r\n  private loadCurrentUser() {\r\n    const token = this.getToken();\r\n    if (token) {\r\n      // Verificar token\r\n      this.verificarToken().subscribe({\r\n        next: (data) => this.currentUserSubject.next(data.user),\r\n        error: () => this.logout()\r\n      });\r\n    }\r\n  }\r\n\r\n  register(userData: any): Observable<any> {\r\n    return this.http.post(`${this.apiUrl}/registro`, userData);\r\n  }\r\n\r\n  login(username: string, password: string): Observable<AuthResponse> {\r\n    return this.http.post<AuthResponse>(`${this.apiUrl}/login`, { username, password })\r\n      .pipe(\r\n        tap(response => {\r\n          localStorage.setItem('token', response.token);\r\n          this.currentUserSubject.next(response.user);\r\n        })\r\n      );\r\n  }\r\n\r\n  logout() {\r\n    localStorage.removeItem('token');\r\n    this.currentUserSubject.next(null);\r\n  }\r\n\r\n  getToken(): string | null {\r\n    return localStorage.getItem('token');\r\n  }\r\n\r\n  isAuthenticated(): boolean {\r\n    return !!this.getToken();\r\n  }\r\n\r\n  isLoggedIn(): boolean {\r\n    return this.isAuthenticated();\r\n  }\r\n\r\n  getCurrentUser(): User | null {\r\n    return this.currentUserSubject.value;\r\n  }\r\n\r\n  verificarToken(): Observable<any> {\r\n    return this.http.get(`${this.apiUrl}/verificar`);\r\n  }\r\n}\r\n"],"mappings":"AAEA,SAAqBA,eAAe,QAAQ,MAAM;AAClD,SAASC,GAAG,QAAQ,gBAAgB;;;AAmBpC,OAAM,MAAOC,WAAW;EAKtBC,YAAoBC,IAAgB;IAAhB,KAAAA,IAAI,GAAJA,IAAI;IAJhB,KAAAC,MAAM,GAAG,gCAAgC;IACzC,KAAAC,kBAAkB,GAAG,IAAIN,eAAe,CAAc,IAAI,CAAC;IAC5D,KAAAO,YAAY,GAAG,IAAI,CAACD,kBAAkB,CAACE,YAAY,EAAE;IAG1D,IAAI,CAACC,eAAe,EAAE;EACxB;EAEQA,eAAeA,CAAA;IACrB,MAAMC,KAAK,GAAG,IAAI,CAACC,QAAQ,EAAE;IAC7B,IAAID,KAAK,EAAE;MACT;MACA,IAAI,CAACE,cAAc,EAAE,CAACC,SAAS,CAAC;QAC9BC,IAAI,EAAGC,IAAI,IAAK,IAAI,CAACT,kBAAkB,CAACQ,IAAI,CAACC,IAAI,CAACC,IAAI,CAAC;QACvDC,KAAK,EAAEA,CAAA,KAAM,IAAI,CAACC,MAAM;OACzB,CAAC;;EAEN;EAEAC,QAAQA,CAACC,QAAa;IACpB,OAAO,IAAI,CAAChB,IAAI,CAACiB,IAAI,CAAC,GAAG,IAAI,CAAChB,MAAM,WAAW,EAAEe,QAAQ,CAAC;EAC5D;EAEAE,KAAKA,CAACC,QAAgB,EAAEC,QAAgB;IACtC,OAAO,IAAI,CAACpB,IAAI,CAACiB,IAAI,CAAe,GAAG,IAAI,CAAChB,MAAM,QAAQ,EAAE;MAAEkB,QAAQ;MAAEC;IAAQ,CAAE,CAAC,CAChFC,IAAI,CACHxB,GAAG,CAACyB,QAAQ,IAAG;MACbC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEF,QAAQ,CAAChB,KAAK,CAAC;MAC7C,IAAI,CAACJ,kBAAkB,CAACQ,IAAI,CAACY,QAAQ,CAACV,IAAI,CAAC;IAC7C,CAAC,CAAC,CACH;EACL;EAEAE,MAAMA,CAAA;IACJS,YAAY,CAACE,UAAU,CAAC,OAAO,CAAC;IAChC,IAAI,CAACvB,kBAAkB,CAACQ,IAAI,CAAC,IAAI,CAAC;EACpC;EAEAH,QAAQA,CAAA;IACN,OAAOgB,YAAY,CAACG,OAAO,CAAC,OAAO,CAAC;EACtC;EAEAC,eAAeA,CAAA;IACb,OAAO,CAAC,CAAC,IAAI,CAACpB,QAAQ,EAAE;EAC1B;EAEAqB,UAAUA,CAAA;IACR,OAAO,IAAI,CAACD,eAAe,EAAE;EAC/B;EAEAE,cAAcA,CAAA;IACZ,OAAO,IAAI,CAAC3B,kBAAkB,CAAC4B,KAAK;EACtC;EAEAtB,cAAcA,CAAA;IACZ,OAAO,IAAI,CAACR,IAAI,CAAC+B,GAAG,CAAC,GAAG,IAAI,CAAC9B,MAAM,YAAY,CAAC;EAClD;;;uBAzDWH,WAAW,EAAAkC,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA;IAAA;EAAA;;;aAAXrC,WAAW;MAAAsC,OAAA,EAAXtC,WAAW,CAAAuC,IAAA;MAAAC,UAAA,EAFV;IAAM;EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}